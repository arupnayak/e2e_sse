const http = require('http');
const { readChunk } = require('./util');

http.createServer((req, res) => {
    fetch('https://laughing-space-xylophone-jrjxw5x4v6qf5v47-5000.app.github.dev/chat', {
        method: "POST", // *GET, POST, PUT, DELETE, etc.
        headers: {
            "Content-Type": "application/json",
            "Connection": "keep-alive"
        },
        body: "{\"messages\":[{\"role\":\"user\",\"content\":\"hi\"},{\"role\":\"system\",\"content\":\"{\\\"citations\\\":[],\\\"intent\\\":\\\"[] (empty array) - Since the user's input is exclusively a greeting, we do not need to generate any search queries.\\\"}\"},{\"role\":\"assistant\",\"content\":\"The requested information is not found in the retrieved data. Please try another query or topic.\"},{\"role\":\"user\",\"content\":\"benefits of u by emaar\"},{\"role\":\"system\",\"content\":\"{\\\"citations\\\":[{\\\"content\\\":\\\"CATEGORY\\\\nEmirates NBD Credit Card Application Process : \\\\n \\\\nCredit Card Eligibility:  \\\\nA quick summary of the minimum income requirements for each card:  \\\\n1. Etihad Guest Visa Elevate: AED 12,000.  \\\\n2. Etihad Guest Visa Inspire: AED 30,000.  \\\\n3. Marriott Bonvoy credit card: AED 20,000.  \\\\n4. U By Emaar Signature card credit card: AED 12,000.  \\\\n5. U By Emaar Visa Infinite credit card: AED 30,000.  \\\\n6. U By Emaar Visa Family credit card: AED 5,000.  \\\\n7. Skywards Signature credit card: AED 12,000.  \\\\n8. Skywards Infinite credit ca rd: AED 30,000.  \\\\nPlease note that these are the minimum income requirements and actual eligibility will depend on a \\\\ncomprehensive evaluation of your financial profile.  \\\\n \\\\n \\\\nEtihad Guest Visa Elevate credit card - \\\\nHere are the key features and benefits of this card:  \\\\n1. Earn 10 Etihad Guest Miles per AED 10 spent on Etihad Airways, hotels, and dining.  \\\\n2. Earn 6 Etihad Guest Miles on all other spends.  \\\\n3. Welcome offer: Up to 200,000 Etihad Guest Miles.  \\\\n4. Get a 50% Etihad Guest Miles redemption discount vouche r upon spending every AED 150,000.  \\\\n5. Earn 2.5 Etihad Tier Miles for every AED 10 spent on all spends.  \\\\n6. Earn 50% more miles when you sign up for the Express Miles program for a nominal fee of AED 250 \\\\nper month.  \\\\n7. Enjoy complimentary airport lounge ac cess to over 1000 lounges worldwide via LoungeKey.  \\\\n8. Avail of concierge services to take care of your time -consuming errands.  \\\\n9. Enjoy valet parking at selected locations in Abu Dhabi.  \\\\n10. The interest rate is 3.25% per month; the minimum payment is 5%  of the outstanding or AED 100, \\\\nwhichever is higher.  \\\\nPlease note that the minimum income required for this card is AED 12,000.  \\\\n \\\\n \\\\n \\\\nEtihad Guest Visa Inspire  credit card â€“  \\\\nHere are the key features and benefits of this card:  \\\\n1. Earn 7 Etihad Guest Miles per AED 10 spent on Etihad Airways, hotels, and dining.  \\\\n2. Earn 4 Etihad Guest Miles on all other spends.  \\\\n3. Welcome offer: Up to 60,000 Etihad Guest Miles.  \\\\n4. Get a 25% Etihad Guest Miles redemption discount voucher upon spending every AED 100,000.  \\\\n5. Earn 2.5 Etihad Tier Miles for every AED 10 spent on all spends.  \\\\n6. Enjoy complimentary airport lounge access to over 1000 lounges worldwide via LoungeKey.  \\\\n7. Avail of co ncierge services to take care of your time -consuming errands.  \\\\n8. Enjoy valet parking at selected locations in Abu Dhabi.  \\\\n9. The interest rate is 3.25% per month; the minimum payment is 5% of the outstanding or AED 100, \\\\nwhichever is higher.  \\\\nPlease note t hat the minimum income required for this card is AED 30,000.  \\\",\\\"id\\\":null,\\\"title\\\":null,\\\"filepath\\\":null,\\\"url\\\":null,\\\"metadata\\\":{\\\"chunking\\\":\\\"orignal document size=778. Scores=1.9514636Org Highlight count=38.\\\"},\\\"chunk_id\\\":\\\"0\\\"},{\\\"content\\\":\\\"CATEGORY\\\\nEmirates NBD Credit Card Application Process : \\\\n \\\\nCredit Card Eligibility:  \\\\nA quick summary of the minimum income requirements for each card:  \\\\n1. Etihad Guest Visa Elevate: AED 12,000.  \\\\n2. Etihad Guest Visa Inspire: AED 30,000.  \\\\n3. Marriott Bonvoy credit card: AED 20,000.  \\\\n4. U By Emaar Signature card credit card: AED 12,000.  \\\\n5. U By Emaar Visa Infinite credit card: AED 30,000.  \\\\n6. U By Emaar Visa Family credit card: AED 5,000.  \\\\n7. Skywards Signature credit card: AED 12,000.  \\\\n8. Skywards Infinite credit ca rd: AED 30,000.  \\\\nPlease note that these are the minimum income requirements and actual eligibility will depend on a \\\\ncomprehensive evaluation of your financial profile.  \\\\n \\\\n \\\\nEtihad Guest Visa Elevate credit card - \\\\nHere are the key features and benefits of this card:  \\\\n1. Earn 10 Etihad Guest Miles per AED 10 spent on Etihad Airways, hotels, and dining.  \\\\n2. Earn 6 Etihad Guest Miles on all other spends.  \\\\n3. Welcome offer: Up to 200,000 Etihad Guest Miles.\\\",\\\"id\\\":null,\\\"title\\\":null,\\\"filepath\\\":null,\\\"url\\\":null,\\\"metadata\\\":{\\\"chunking\\\":\\\"orignal document size=313. Scores=2.0959978Org Highlight count=18.\\\"},\\\"chunk_id\\\":\\\"0\\\"},{\\\"content\\\":\\\"CATEGORY\\\\n6. Enjoy a complimentary upgrade to a suite on hotel stays.  \\\\n7. Get up to 30% discount on entertainment at Emaar Entertainment Group.  \\\\n8. Enjoy Buy 1 get 1 free on movie tickets at Reel Cinemas.  \\\\n9. Enjoy complimentary airport lounge access to over 1000 lounges worldwide via LoungeKey.  \\\\n10. Avail of concierge services to take care of your time -consuming errands.  \\\\n11. Enjoy complimentary valet parking at The Grand Parking, The Dubai Mall.  \\\\n12. The i nterest rate is 3.25% per month; the minimum payment is 5% of the outstanding or AED 100, \\\\nwhichever is higher.  \\\\nPlease note that the minimum income required for this card is AED 30,000 . \\\\n \\\\n \\\\n \\\\nU By Emaar Visa Family credit card :  \\\\nHere are the key features and benefits of this card:  \\\\n1. Earn Upoints on spends: 1% for all spends and 5x extra on spends in Emaar.  \\\\n2. Earn 25% base Upoints for spends in grocery and supermarkets.  \\\\n3. Earn 10% base Upoints for spends in fuel, government services, and telecommunication  payments.\\\",\\\"id\\\":null,\\\"title\\\":null,\\\"filepath\\\":null,\\\"url\\\":null,\\\"metadata\\\":{\\\"chunking\\\":\\\"orignal document size=286. Scores=2.311395Org Highlight count=18.\\\"},\\\"chunk_id\\\":\\\"0\\\"},{\\\"content\\\":\\\"CATEGORY\\\\ncard.  \\\\n4. Enjoy VIP access to Marriott Bonvoy Moments.  \\\\n5. Earn 6 Marriott Bonvoy Points per US$1 spent at hotels participating in Marriott Bonvoy.  \\\\n6. Earn 3 Marriott Bonvoy Points per US$1 on international and all other spends.  \\\\n7. Have a chance to earn up to 50% more points every month on retail purchases if you enroll in the \\\\nExpress Points Programme for a monthly fee of AED 300.  \\\\n8. Transfer points to over 40 airlines for flight bookings.  \\\\nPlease note that the minimum income req uired for this card is AED 20,000.  \\\\n \\\\n \\\\nU By Emaar Signature card credit card :  \\\\nHere are the key features and benefits of this card:  \\\\n1. Earn UPoints on spends: 6.25% on all Emaar spends and 1.25% on all other spends.  \\\\n2. Redeem UPoints instantly at over 2500 + stores across your favorite brands.  \\\\n3. Receive U By Emaar Gold Status.  \\\\n4. Get 15% off on F&B and Spas at Emaar Hospitality Group Hotels.  \\\\n5. Enjoy a complimentary upgrade to a suite on hotel stays.\\\",\\\"id\\\":null,\\\"title\\\":null,\\\"filepath\\\":null,\\\"url\\\":null,\\\"metadata\\\":{\\\"chunking\\\":\\\"orignal document size=284. Scores=2.3810773Org Highlight count=15.\\\"},\\\"chunk_id\\\":\\\"0\\\"},{\\\"content\\\":\\\"CATEGORY\\\\n6. Get up to 30% discount on entertainment at Emaar E ntertainment Group.  \\\\n7. Enjoy an Exclusive Buy -One-Get-One free at Reel Cinemas with complimentary soft drinks and \\\\npopcorn.  \\\\n8. Enjoy complimentary airport lounge access to over 1000 lounges worldwide via LoungeKey.  \\\\n9. The interest rate is 3.25% per month ; the minimum payment is 5% of the outstanding or AED 100, \\\\nwhichever is higher.  \\\\nPlease note that the minimum income required for this card is AED 12,000.  \\\\n \\\\n \\\\nU By Emaar Visa Infinite credit card :  \\\\nHere are the key features and benefits of this card:  \\\\n1. Ea rn UPoints on spends: 7.5% on all Emaar spends and 1.5% on all other spends.  \\\\n2. Redeem UPoints instantly at over 2500+ stores across your favorite brands.  \\\\n3. Welcome offer: Up to 25,000 UPoints.  \\\\n4. Receive U By Emaar Platinum status.  \\\\n5. Get 20% off on F&B and spas at Emaar Hospitality Group Hotels.\\\",\\\"id\\\":null,\\\"title\\\":null,\\\"filepath\\\":null,\\\"url\\\":null,\\\"metadata\\\":{\\\"chunking\\\":\\\"orignal document size=276. Scores=4.0324864Org Highlight count=18.\\\"},\\\"chunk_id\\\":\\\"0\\\"}],\\\"intent\\\":\\\"[\\\\\\\"What are the benefits of U by Emaar?\\\\\\\", \\\\\\\"U by Emaar advantages\\\\\\\", \\\\\\\"U by Emaar perks\\\\\\\", \\\\\\\"U by Emaar features\\\\\\\", \\\\\\\"U by Emaar benefits and features\\\\\\\"]\\\"}\"},{\"role\":\"assistant\",\"content\":\"Emirates NBD offers several U By Emaar credit cards, each with its own set of benefits[doc1]. The U By Emaar Visa Family credit card allows you to earn Upoints on all spends, with 1% for all spends and 5x extra on spends in Emaar[doc3]. The U By Emaar Signature card credit card allows you to earn UPoints on spends, with 6.25% on all Emaar spends and 1.25% on all other spends[doc4]. The U By Emaar Visa Infinite credit card allows you to earn UPoints on spends, with 7.5% on all Emaar spends and 1.5% on all other spends[doc5]. All U By Emaar credit cards offer complimentary airport lounge access to over 1000 lounges worldwide via LoungeKey[doc1][doc3][doc5]. Other benefits include discounts on entertainment at Emaar Entertainment Group, complimentary upgrades to suites on hotel stays, and concierge services to take care of your time-consuming errands[doc1][doc3][doc4][doc5].\"},{\"role\":\"user\",\"content\":\"what are other credit card options?\"}],\"temperature\":0,\"top_p\":1,\"max_tokens\":800,\"stop\":null,\"stream\":true}",
    })
        .then(response => {
            // Get the readable stream from the response body
            const stream = response.body;
            // Get the reader from the stream
            const reader = stream.getReader();

            // Start reading the first chunk
            readChunk(reader, res);
        })
        .catch(error => {
            // Log the error
            console.error('err',error);
        });

}).listen(8000);
